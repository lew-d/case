<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>case</title>
	<link rel="stylesheet" href="https://necolas.github.io/normalize.css/8.0.1/normalize.css">
	<link rel="stylesheet" href="/css/main.css">
</head>
<body>
	<script src="/socket.io/socket.io.js"></script>
	<script src="https://code.jquery.com/jquery-1.11.1.js"></script>

	

	<form id="uploadForm" class="upload" action="/add_image" method="post" enctype="multipart/form-data">
		<input type="file" id="file" name="img" title=""/>
	</form>

	<div class="columns"><h2>// case by lew & eti</h2></div>

	<script>
		// variables
		var socket = io();
		var loaded = false;

		// exec
		socket.on("thumb_list", function(msg) {
			if (loaded == false) {
				for (var i in msg) {
					$(".columns").append($("<img>", {src: "thumbnails/" + msg[i]}));
				}
				loaded = true;
			}
		});

		socket.on("remove_client", function(file) {
			location.reload();
		})

		col = 0;

		socket.on("update_client", function(file) {
			$("#" + col).append($("<img>", {src: "thumbnails/" + file}));
			col ++;
			if (col == 4) {
				col = 1
			}
		})

		window.reset = function(e) {
			e.wrap('<form>').closest('form').get(0).reset();
			e.unwrap();
		}

		$("input").change(function() {
			$("form").submit();
			reset($('#file'))
		});
	</script>
</body>
</html>
<script>
	document.body.addEventListener('dragenter', function(e) {
		$("#uploadForm").css("pointer-events", "all");
	});

	document.body.addEventListener('mouseover', function(e) {
		$("#uploadForm").css("pointer-events", "none");
	});
</script>